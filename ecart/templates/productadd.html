{% extends 'adminbase.html' %}

{% block content %}
{% load static %}
               
                    <!-- Header -->
                    <div class="header bg-primary pb-6">
                      <div class="container-fluid">
                        <div class="header-body">
                          <div class="row align-items-center py-4">
                            <div class="col-lg-6 col-7">
                              <h6 class="h2 text-white d-inline-block mb-0">Product List</h6>
                              <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
                                <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
                                  <li class="breadcrumb-item"><a href=""><i class="fas fa-home"></i></a></li>
                                  <li class="breadcrumb-item"><a href="">Product</a></li>
                                  <li class="breadcrumb-item active" aria-current="page">Product</li>
                                </ol>
                              </nav>
                            </div>
                            <div class="col-lg-6 col-5 text-right">
                              <a href="{% url 'addproduct' %}" class="btn btn-sm btn-neutral">New</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Page content -->
                    <div class="container-fluid mt--6">
                      <div class="row">
                        <div class="col">
                          <div class="card">
                            <!-- Card header -->
                            <div class="card-header border-0">
                              <h2 class="mb-0">Add Product</h2>
                            </div>
                            <!-- Light table -->
                            <form class="form-horizontal" action="{% url 'addproduct' %}" method="POST" enctype="multipart/form-data" >
                              {% csrf_token %}
                              <div class="table-responsive">
                                  <div class="control-group" style="margin: 40px;">
                                    <div class="controls" style=" padding-left: 67px;">
                                      <label class="control-label" style="padding-right: 64px;" for="full_name">Product
                                        Name</label>
                                      <input id="full_name" name="name" placeholder="Productname" class="input-xlarge" type="text">
                                    </div>
                                  </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" style="padding-right: 74px;" for="course">Product Type</label>
                                  <select id="course" name="category" class="input-xlarge">
                                    <option>Select Type</option>
                                    <option>Laptop</option>
                                    <option>Smartphone</option>
                                    <option>Accessories</option>
                                  </select>
                                </div>
                              </div>
                    
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" style="padding-right: 44px;">Product_Quantity</label>
                                  <input name="product_quantity" type="text">
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" style="padding-right: 46px;">Product Features</label>
                                  <textarea id="Address" name="features"></textarea>
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" style="padding-right: 26px;">Product Description</label>
                                  <textarea id="Address" name="description"></textarea>
                                </div>
                              </div>
                    
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" style="padding-right: 136px;">Price</label>
                                  <input id="mother_name" name="oldprice" placeholder="Old_price" class="input-xlarge" type="text">
                    
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" for="mother_name" style="padding-right: 67px;">After discount
                                  </label>
                                  <input id="mother_name" name="newprice" placeholder="New_price" class="input-xlarge" type="text">
                                </div>
                              </div>
                              <div class="control-group">
                                <label class="control-label" for="photo"></label>
                                <div class="controls">
                                    <input required = True id="imageBaseData" class="hidden" name="image64data" class="input-file" type="text" >
            
                                    <main class="page">
                                        <label class="control-label" for="full_name">Product Photo</label>
                                       
                                        <div class="box">
                                            <input  type="file" id="file-input">
                                        </div>
                                        
                                        <div class="box-2">
                                            <div class="result"></div>
                                        </div>
                                        
                                        <div class="box-2 img-result hide">
                                            
                                            <img id="cropped" class="cropped"  src="" alt="">
                                        </div>
                                        
                                        <div class="box">
                                            <div class="options hide">
                                                <input type="number" name="myfile" class="img-w hidden" value="300" min="100" max="1200" />
                                            </div>
                                            <button class="btn btn-info save hide" id="load" type="button">Confirm</button>    
                                        </div>
                                    </main>


                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" for="mother_name" style="padding-right: 85px;">Full ViewImage_1
                                  </label>
                                  <input id="mother_name" name="fileone" placeholder="Select Image" class="input-xlarge" type="file">
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" for="mother_name" style="padding-right: 85px;">Full ViewImage_2
                                  </label>
                                  <input id="mother_name" name="filetwo" placeholder="Select Image" class="input-xlarge" type="file">
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" for="mother_name" style="padding-right: 85px;">Full ViewImage_3
                                  </label>
                                  <input id="mother_name" name="filethree" placeholder="Select Image" class="input-xlarge" type="file">
                                </div>
                              </div>
                              <div class="control-group" style="margin: 40px;">
                                <div class="controls" style=" padding-left: 67px;">
                                  <label class="control-label" for="mother_name" style="padding-right: 85px;">Full ViewImage_4
                                  </label>
                                  <input id="mother_name" name="filefour" placeholder="Select Image" class="input-xlarge" type="file">
                                </div>
                              </div>

                              <!-- Button -->
                              <div class="control-group" style="margin: 40px;">
                                <label class="control-label" for="submit"></label>
                                <div class="controls" style=" padding-left: 384px;">
                                  <button type="submit" class="btn btn-info btn-md" data-target="#myModal">Save</button>
                                </div>
                              </div>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                    </div>
                    
                    <style>
                      .hidden{
                        display:none;
                        visibility:hidden;
                        }

                      .page {
                        margin: 1em auto;
                        max-width: 768px;
                        display: flex;
                        align-items: flex-start;
                        flex-wrap: wrap;
                        height: 100%;
                      }
                      
                      .box {
                        padding: 0.8em;
                        width: 100%;
                        margin:0.5em;
                      }
                      
                      .box-2 {
                        padding: 0.5em;
                        width: calc(100%/2 - 1em);
                      }
                      
                      .options label,
                      .options input{
                        width:4em;
                        padding:0.5em 1em;
                      }
                      .btnm{
                        background:white;
                        color:black;
                        border:1px solid black;
                        padding: 0.5em 1em;
                        text-decoration:none;
                        margin:0.8em 0.3em;
                        display:inline-block;
                        cursor:pointer;
                      }
                      
                      .hide {
                        display: none;
                        padding-left: 20px;
                      }
                      
                      img {
                        max-width: 100%;
                      }
                      
                      </style>
<script>
// vars
let result = document.querySelector('.result'),
img_result = document.querySelector('.img-result'),
img_w = document.querySelector('.img-w'),
img_h = document.querySelector('.img-h'),
options = document.querySelector('.options'),
save = document.querySelector('.save'),
cropped = document.querySelector('.cropped'),
dwn = document.querySelector('.download'),
upload = document.querySelector('#file-input'),
cropper = '';

// on change show image with crop options
upload.addEventListener('change', (e) => {
if (e.target.files.length) {
  // start file reader
  const reader = new FileReader();
  reader.onload = (e)=> {
    if(e.target.result){
      // create new image
      let img = document.createElement('img');
      img.id = 'image';
      img.src = e.target.result
      // clean result before
      result.innerHTML = '';
      // append new image
      result.appendChild(img);
      // show save btn and options
      save.classList.remove('hide');
      options.classList.remove('hide');
      // init cropper
      cropper = new Cropper(img);
    }
  };
  reader.readAsDataURL(e.target.files[0]);
}
});

// save on click
save.addEventListener('click',(e)=>{
e.preventDefault();
// get result to data uri
let imgSrc = cropper.getCroppedCanvas({
  width: img_w.value // input value
}).toDataURL();
// remove hide class of img
cropped.classList.remove('hide');
img_result.classList.remove('hide');
// show image cropped
cropped.src = imgSrc;
dwn.classList.remove('hide');
dwn.download = 'imagename.png';
dwn.setAttribute('href',imgSrc);

});

</script>
<script>
  var button = document.getElementById('load');
  button.addEventListener('click',function(){
      setImageData();
      console.log('Cropped')
  })
  

  function setImageData(){
      
      var imageElement = document.getElementById('cropped');
      var imageData = imageElement.src;
      var hiddenElement = document.getElementById("imageBaseData");
      hiddenElement.value = imageData;
      console.log("data set")
  }
</script>
{% endblock %}